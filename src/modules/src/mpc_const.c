#include "mpc_const.h" 

const real_t HoL[] = { /* Quadratic term (Hessian) matrix of QP over Lipschitz constant. */
0.9933912021879036, 0.0015025376729589641, 0.0012998552693388125, 0.001110115606165702, 0.0009314594050256364, 0.0007621383145179287, 0.0006004974121667378, 0.00044495864140069413, 0.0002940050178323294, 0.00014616544676845087, 
0.0015025376729589641, 0.9933303325498816, 0.0014355220912587654, 0.0012260473694211953, 0.0010288010336878776, 0.0008418486763427554, 0.0006633589152654061, 0.0004915850648432312, 0.00032484765455476506, 0.00016151762026420663, 
0.0012998552693388125, 0.0014355220912587654, 0.993256507674559, 0.0013541717826523973, 0.0011363801708035054, 0.0009299422501008414, 0.0007328316203565764, 0.0005431152320458036, 0.000358934039697173, 0.0001784843959409676, 
0.001110115606165702, 0.0012260473694211953, 0.0013541717826523973, 0.9931668217152176, 0.0012552735045353698, 0.00102730070588763, 0.0008096108336233839, 0.0006000648742416621, 0.0003966053212588881, 0.00019723558299243713, 
0.0009314594050256364, 0.0010288010336878776, 0.0011363801708035054, 0.0012552735045353698, 0.9930577215164955, 0.0011348984398519427, 0.0008944649872385874, 0.0006630039625913389, 0.0004382385260875349, 0.00021795884960111787, 
0.0007621383145179287, 0.0008418486763427554, 0.0009299422501008414, 0.00102730070588763, 0.0011348984398519427, 0.9929248628834467, 0.000988243330092034, 0.0007325624126455954, 0.00048425033329044205, 0.00024086160118455994, 
0.0006004974121667378, 0.0006633589152654061, 0.0007328316203565764, 0.0008096108336233839, 0.0008944649872385874, 0.000988243330092034, 0.9927629349845257, 0.0008094363887519773, 0.0005351012444991986, 0.0002661730561784912, 
0.00044495864140069413, 0.0004915850648432312, 0.0005431152320458036, 0.0006000648742416621, 0.0006630039625913389, 0.0007325624126455954, 0.0008094363887519773, 0.9925654458286683, 0.0005913001927247635, 0.00029414654013196456, 
0.0002940050178323294, 0.00032484765455476506, 0.000358934039697173, 0.0003966053212588881, 0.0004382385260875349, 0.00048425033329044205, 0.0005351012444991986, 0.0005913001927247635, 0.9923244601930968, 0.0003250620210745992, 
0.00014616544676845087, 0.00016151762026420663, 0.0001784843959409676, 0.00019723558299243713, 0.00021795884960111787, 0.00024086160118455994, 0.0002661730561784912, 0.00029414654013196456, 0.0003250620210745992, 0.9920302794686973, 
 
};
const real_t GoL[] = { /* Linear term matrix of the QP, over Lipschitz constant. */
0.00729630783809735, 0.08181473711680651, 
0.00608032513087826, 0.07146302978644073, 
0.004945046315609105, 0.06182159011824195, 
0.0038989590946985364, 0.0527959083388482, 
0.002951443830009879, 0.04429763738681215, 
0.0021128674246755044, 0.03624370870551555, 
0.001394687078547815, 0.02855550086513427, 
0.0008095649557062686, 0.021158052692943127, 
0.00037149491165138317, 0.013979313036703848, 
9.594254851408434e-05, 0.006949419652516304, 

};
const real_t Bh_T[] = { /* Extended input matrix (used for reference tracking). */
9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 0.0005900365070784287, 0.014099634929215708, 0.0007242122735398825, 0.012757877264601168, 0.0008456195276278601, 0.011543804723721391, 0.0009554733539476615, 0.010445266460523376, 0.0010548732065162414, 0.009451267934837575, 0.00114481391246755, 0.008551860875324486, 0.0012261956286168639, 0.007738043713831347, 
0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 0.0005900365070784287, 0.014099634929215708, 0.0007242122735398825, 0.012757877264601168, 0.0008456195276278601, 0.011543804723721391, 0.0009554733539476615, 0.010445266460523376, 0.0010548732065162414, 0.009451267934837575, 0.00114481391246755, 0.008551860875324486, 
0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 0.0005900365070784287, 0.014099634929215708, 0.0007242122735398825, 0.012757877264601168, 0.0008456195276278601, 0.011543804723721391, 0.0009554733539476615, 0.010445266460523376, 0.0010548732065162414, 0.009451267934837575, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 0.0005900365070784287, 0.014099634929215708, 0.0007242122735398825, 0.012757877264601168, 0.0008456195276278601, 0.011543804723721391, 0.0009554733539476615, 0.010445266460523376, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 0.0005900365070784287, 0.014099634929215708, 0.0007242122735398825, 0.012757877264601168, 0.0008456195276278601, 0.011543804723721391, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 0.0005900365070784287, 0.014099634929215708, 0.0007242122735398825, 0.012757877264601168, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 0.0005900365070784287, 0.014099634929215708, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 0.0004417493520747202, 0.015582506479252795, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 0.0002778667008404458, 0.01722133299159554, 
0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.67483607191915e-05, 0.019032516392808087, 

};
const real_t E[] = { /* Linear factor (prediction matrix) of 2-sided state constraint. */
0, 

};
const real_t Kx_Ai[] = { /* Prediction component of the state constraint bound. */
0, 

};

const real_t u_lb[] = { /* Left (lower) constraint of the inputs for condensed QP. */
-100, 
-100, 
-100, 
-100, 
-100, 
-100, 
-100, 
-100, 
-100, 
-100, 

};
const real_t u_ub[] = { /* Right (upper) constraint of the inputs for condensed QP. */
100, 
100, 
100, 
100, 
100, 
100, 
100, 
100, 
100, 
100, 

};
const real_t e_lb[] = { /* Left (lower) constraint of the states for condensed QP. */
0, 

};
const real_t e_ub[] = { /* Right (upper) constraint of the states for condensed QP. */
0, 

};

const real_t nu = 0.0020654343427368915; /* Fast gradient extra step constant */
const real_t mu = 0.0; /* Augmented Lagrange multiplier penalty parameter. */
const real_t Linv = 0.9916710505571666; /* Inverse of gradient Lipschitz constant (1/L) */

/* state dependent variables */
real_t gxoL[MPC_HOR_INPUTS];  /* gradient vector as a function of the current state */
real_t zx_lb[MPC_HOR_MXCONSTRS];  /* mixed constraint lower bound as function of current state */
real_t zx_ub[MPC_HOR_MXCONSTRS];  /* mixed constraint upper bound as function of current state */

/* reference dependent variables */
real_t groL[MPC_HOR_INPUTS];

/* MPC system: state-space and weighting matrices */
const real_t Q[] = {  /* State weighting matrix */
1, 0, 
0, 1, 

};
const real_t R[] = {   /* Input weighting matrix */
1, 

};
const real_t P[] = {   /* Terminal state weighting matrix */
1, 0, 
0, 1, 

};
const real_t K[] = {   /* Linear quadratic regulator gain matrix */
0, 

};
const real_t Ad[] = {   /* Discrete-time system matrix */
1.0, 0.009516258196404042, 
0.0, 0.9048374180359594, 

};
const real_t Bd[] = {   /* Discrete-time input matrix */
9.67483607191915e-05, 
0.019032516392808087, 

};
const real_t dt = 0.01;


/* User variables created with appropriate size */
real_t u_opt[MPC_HOR_INPUTS];  /* Optimal input */
real_t l_opt[MPC_HOR_MXCONSTRS];  /* Optimal multiplier */
real_t x_trj[MPC_HOR_STATES + MPC_STATES];  /* State trajectory for u_opt */
real_t u_ini[MPC_HOR_INPUTS];  /* Initial guess input */
real_t l_ini[MPC_HOR_MXCONSTRS];  /* Initial guess multiplier */
real_t ctl_x_ref[MPC_HOR_STATES];  /* Reference for state trajectory */
real_t ctl_u_ref[MPC_HOR_INPUTS];  /* Reference for input trajectory */

/* Always check this declarations match the structure definitions */
struct mpc_conf conf = {1, 1, 0};

struct mpc_qpx qpx = {HoL, gxoL, E, u_lb, u_ub, zx_lb, zx_ub,
		MPC_HOR_INPUTS, MPC_HOR_MXCONSTRS};

struct mpc_sys sys = {Ad, Bd, &dt};

struct mpc_wmx wmx = {Q, R, P,};

struct mpc_lqr lqr = {K, P,};

struct mpc_fgm fgm = {u_ini, gxoL, groL, &(conf.in_iter),
			HoL, GoL, Bh_T, u_lb, u_ub, &nu,
			MPC_HOR, MPC_STATES, MPC_INPUTS, MPC_HOR_INPUTS, MPC_HOR_STATES};

struct mpc_alm alm = {&fgm, l_ini, zx_lb, zx_ub, &(conf.ex_iter),
			&mu,
			E, Kx_Ai, e_lb, e_ub,
			&Linv, 
			MPC_STATES, MPC_MXCONSTRS, MPC_HOR_INPUTS, MPC_HOR_MXCONSTRS};

struct mpc_ctl ctl = {&conf, &qpx, &sys, &wmx, &lqr, &alm,
			u_opt, l_opt, x_trj, 0, 0, u_ini, l_ini};

